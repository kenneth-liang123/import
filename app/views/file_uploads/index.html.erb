<div class="max-w-6xl mx-auto">
  <!-- Header -->
  <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 text-white p-8 rounded-xl shadow-2xl mb-8 relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-r from-blue-400/20 via-purple-400/20 to-indigo-500/20 animate-pulse"></div>
    <div class="relative z-10">
      <div class="flex items-center space-x-4 mb-4">
        <div class="text-5xl animate-bounce">ğŸ“Š</div>
        <div>
          <h1 class="text-4xl font-bold mb-2">File Upload Center</h1>
          <p class="text-xl opacity-90">Upload Excel or CSV files to import dailies and health pillar data</p>
        </div>
      </div>
      <div class="mt-6 flex flex-wrap gap-4 text-sm">
        <div class="bg-white/20 backdrop-blur rounded-lg px-3 py-2 flex items-center space-x-2">
          <span class="text-green-300">âœ…</span>
          <span>Excel (.xlsx, .xls)</span>
        </div>
        <div class="bg-white/20 backdrop-blur rounded-lg px-3 py-2 flex items-center space-x-2">
          <span class="text-green-300">âœ…</span>
          <span>CSV Files</span>
        </div>
        <div class="bg-white/20 backdrop-blur rounded-lg px-3 py-2 flex items-center space-x-2">
          <span class="text-blue-300">âš¡</span>
          <span>Background Processing</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Form -->
  <div class="bg-white rounded-xl shadow-2xl p-8 mb-8 border border-gray-100">
    <div class="flex items-center space-x-3 mb-6">
      <div class="text-3xl">ğŸ“¤</div>
      <h2 class="text-2xl font-semibold text-gray-800">Upload New File</h2>
    </div>
    
    <%= form_with model: @new_file_upload, local: true, multipart: true, class: "space-y-6" do |form| %>
      <% if @new_file_upload.errors.any? %>
        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
          <h3 class="text-lg font-medium text-red-800 mb-2">Please fix the following errors:</h3>
          <ul class="list-disc list-inside text-red-700">
            <% @new_file_upload.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- File Upload -->
      <div class="space-y-3">
        <%= form.label :file, "Choose Your File", class: "block text-sm font-medium text-gray-700 flex items-center space-x-2" %>
        <div class="relative">
          <div class="border-2 border-dashed border-blue-300 rounded-xl p-8 text-center hover:border-blue-400 hover:bg-blue-50/30 transition-all duration-300 group cursor-pointer bg-gradient-to-br from-blue-50/20 to-purple-50/20">
            <div class="text-4xl mb-4 group-hover:scale-110 transition-transform duration-300">ğŸ“</div>
            <%= form.file_field :file, 
                accept: ".xlsx,.xls,.csv",
                class: "absolute inset-0 w-full h-full opacity-0 cursor-pointer",
                onchange: "updateFileName(this)" %>
            <div class="space-y-2">
              <p class="text-lg font-medium text-gray-700 group-hover:text-blue-600 transition-colors">
                Drop your file here or <span class="text-blue-600 underline">click to browse</span>
              </p>
              <div class="flex items-center justify-center space-x-4 text-sm text-gray-500">
                <span class="bg-white px-3 py-1 rounded-full border">ğŸ“Š Excel (.xlsx, .xls)</span>
                <span class="bg-white px-3 py-1 rounded-full border">ğŸ“„ CSV (.csv)</span>
              </div>
              <p class="text-xs text-gray-400">Maximum file size: 10MB</p>
            </div>
          </div>
          <div id="file-name" class="mt-2 text-sm text-gray-600 hidden"></div>
        </div>
      </div>

      <script>
        function updateFileName(input) {
          const fileName = input.files[0]?.name;
          const fileNameDiv = document.getElementById('file-name');
          if (fileName) {
            fileNameDiv.textContent = `Selected: ${fileName}`;
            fileNameDiv.classList.remove('hidden');
          } else {
            fileNameDiv.classList.add('hidden');
          }
        }
      </script>

      <!-- File Type Selection -->
      <div class="space-y-3">
        <%= form.label :file_type, "What type of data are you uploading?", class: "block text-sm font-medium text-gray-700" %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <label class="relative flex items-start p-6 border-2 rounded-xl cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 group">
            <%= form.radio_button :file_type, "dailies", class: "sr-only peer" %>
            <div class="w-5 h-5 border-2 border-gray-300 rounded-full peer-checked:border-blue-500 peer-checked:bg-blue-500 mr-4 mt-1 flex-shrink-0 relative">
              <div class="w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0 peer-checked:opacity-100"></div>
            </div>
            <div class="flex-1">
              <div class="flex items-center space-x-2 mb-2">
                <span class="text-2xl">ğŸ“‹</span>
                <span class="font-semibold text-gray-900 group-hover:text-blue-700">Dailies</span>
              </div>
              <div class="text-sm text-gray-600">Import daily activities, routines, and task data</div>
              <div class="text-xs text-gray-400 mt-1">Expected columns: date, activity, category, etc.</div>
            </div>
          </label>
          
          <label class="relative flex items-start p-6 border-2 rounded-xl cursor-pointer hover:bg-purple-50 hover:border-purple-300 transition-all duration-200 group">
            <%= form.radio_button :file_type, "daily_health_pillars", class: "sr-only peer" %>
            <div class="w-5 h-5 border-2 border-gray-300 rounded-full peer-checked:border-purple-500 peer-checked:bg-purple-500 mr-4 mt-1 flex-shrink-0 relative">
              <div class="w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0 peer-checked:opacity-100"></div>
            </div>
            <div class="flex-1">
              <div class="flex items-center space-x-2 mb-2">
                <span class="text-2xl">ğŸ¥</span>
                <span class="font-semibold text-gray-900 group-hover:text-purple-700">Health Pillars</span>
              </div>
              <div class="text-sm text-gray-600">Import daily-health pillar relationship data</div>
              <div class="text-xs text-gray-400 mt-1">Expected columns: daily_id, health_pillar_id, etc.</div>
            </div>
          </label>
        </div>
      </div>

      <!-- Import Behavior -->
      <div class="space-y-3">
        <%= form.label :import_type, "How should we handle existing data?", class: "block text-sm font-medium text-gray-700" %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <label class="relative flex items-start p-6 border-2 rounded-xl cursor-pointer hover:bg-green-50 hover:border-green-300 transition-all duration-200 group">
            <%= form.radio_button :import_type, "import", class: "sr-only peer" %>
            <div class="w-5 h-5 border-2 border-gray-300 rounded-full peer-checked:border-green-500 peer-checked:bg-green-500 mr-4 mt-1 flex-shrink-0 relative">
              <div class="w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0 peer-checked:opacity-100"></div>
            </div>
            <div class="flex-1">
              <div class="flex items-center space-x-2 mb-2">
                <span class="text-2xl">â•</span>
                <span class="font-semibold text-gray-900 group-hover:text-green-700">Import New Only</span>
              </div>
              <div class="text-sm text-gray-600">Add new records, skip any existing ones</div>
              <div class="text-xs text-green-600 mt-1">Safest option - no data will be overwritten</div>
            </div>
          </label>
          
          <label class="relative flex items-start p-6 border-2 rounded-xl cursor-pointer hover:bg-orange-50 hover:border-orange-300 transition-all duration-200 group">
            <%= form.radio_button :import_type, "update", class: "sr-only peer" %>
            <div class="w-5 h-5 border-2 border-gray-300 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-500 mr-4 mt-1 flex-shrink-0 relative">
              <div class="w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0 peer-checked:opacity-100"></div>
            </div>
            <div class="flex-1">
              <div class="flex items-center space-x-2 mb-2">
                <span class="text-2xl">ğŸ”„</span>
                <span class="font-semibold text-gray-900 group-hover:text-orange-700">Import & Update</span>
              </div>
              <div class="text-sm text-gray-600">Add new records and update existing ones</div>
              <div class="text-xs text-orange-600 mt-1">Will overwrite existing data with new values</div>
            </div>
          </label>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="pt-6">
        <%= form.submit "ğŸš€ Upload & Process File", 
            class: "w-full bg-gradient-to-r from-blue-500 via-purple-600 to-indigo-600 text-white font-bold py-4 px-8 rounded-xl hover:from-blue-600 hover:via-purple-700 hover:to-indigo-700 transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-[1.02] focus:outline-none focus:ring-4 focus:ring-blue-300",
            onclick: "this.disabled=true; this.value='â³ Processing...'; this.form.submit();" %>
        <p class="text-center text-sm text-gray-500 mt-3">
          Files are processed in the background. You can safely leave this page.
        </p>
      </div>
    <% end %>
  </div>

  <!-- Recent Uploads -->
  <div class="bg-white rounded-xl shadow-2xl p-8 border border-gray-100">
    <div class="flex items-center space-x-3 mb-8">
      <div class="text-3xl">ğŸ“š</div>
      <h2 class="text-2xl font-semibold text-gray-800">Recent Uploads</h2>
      <div class="flex-1"></div>
      <div class="text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full">
        <%= @file_uploads.count %> uploads
      </div>
    </div>
    
    <% if @file_uploads.any? %>
      <div class="overflow-x-auto rounded-xl border border-gray-200">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
            <tr>
              <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">ğŸ“„ File</th>
              <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">ğŸ·ï¸ Type</th>
              <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">âš™ï¸ Behavior</th>
              <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">ğŸ“Š Status</th>
              <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">â° Uploaded</th>
              <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">ğŸ”§ Actions</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-100">
            <% @file_uploads.each_with_index do |upload, index| %>
              <tr class="hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all duration-200 <%= 'bg-gray-50/30' if index.even? %>">
                <td class="px-6 py-5 whitespace-nowrap">
                  <div class="flex items-center space-x-3">
                    <div class="text-2xl">
                      <%= upload.file_type == 'dailies' ? 'ğŸ“‹' : 'ğŸ¥' %>
                    </div>
                    <div>
                      <div class="text-sm font-semibold text-gray-900"><%= upload.filename %></div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-5 whitespace-nowrap">
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border border-blue-300">
                    <%= upload.file_type.humanize %>
                  </span>
                </td>
                <td class="px-6 py-5 whitespace-nowrap">
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border
                    <%= upload.import_type == 'import' ? 'bg-gradient-to-r from-green-100 to-green-200 text-green-800 border-green-300' : 'bg-gradient-to-r from-orange-100 to-orange-200 text-orange-800 border-orange-300' %>">
                    <%= upload.import_type == 'import' ? 'â• ' : 'ğŸ”„ ' %><%= upload.import_type.humanize %>
                  </span>
                </td>
                <td class="px-6 py-5 whitespace-nowrap">
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border
                    <%= case upload.status
                        when 'pending' then 'bg-gradient-to-r from-yellow-100 to-yellow-200 text-yellow-800 border-yellow-300'
                        when 'processing' then 'bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 border-blue-300 animate-pulse'
                        when 'completed' then 'bg-gradient-to-r from-green-100 to-green-200 text-green-800 border-green-300'
                        when 'failed' then 'bg-gradient-to-r from-red-100 to-red-200 text-red-800 border-red-300'
                        end %>">
                    <%= case upload.status
                        when 'pending' then 'â³ '
                        when 'processing' then 'âš™ï¸ '
                        when 'completed' then 'âœ… '
                        when 'failed' then 'âŒ '
                        end %><%= upload.status.humanize %>
                  </span>
                </td>
                <td class="px-6 py-5 whitespace-nowrap">
                  <div class="text-sm text-gray-600 flex items-center space-x-1">
                    <span>ğŸ•’</span>
                    <span><%= time_ago_in_words(upload.created_at) %> ago</span>
                  </div>
                  <div class="text-xs text-gray-400">
                    <%= upload.created_at.strftime("%b %d, %Y at %I:%M %p") %>
                  </div>
                </td>
                <td class="px-6 py-5 whitespace-nowrap">
                  <div class="flex items-center space-x-2">
                    <%= link_to upload, class: "inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-sm hover:shadow-md" do %>
                      <span class="mr-1">ğŸ‘ï¸</span>
                      View
                    <% end %>
                    <% if upload.can_retry? %>
                      <%= link_to retry_file_upload_path(upload), 
                          method: :post,
                          class: "inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-sm hover:shadow-md",
                          data: { confirm: "Are you sure you want to retry processing this file?" } do %>
                        <span class="mr-1">ğŸ”„</span>
                        Retry
                      <% end %>
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="text-center py-16">
        <div class="relative">
          <div class="text-gray-300 text-8xl mb-6 animate-bounce">ğŸ“‚</div>
          <div class="absolute top-0 left-1/2 transform -translate-x-1/2 text-6xl animate-pulse">âœ¨</div>
        </div>
        <h3 class="text-xl font-semibold text-gray-700 mb-3">No uploads yet</h3>
        <p class="text-gray-500 mb-6">Upload your first file to get started with data processing</p>
        <div class="inline-flex items-center space-x-2 text-sm text-gray-400 bg-gray-50 px-4 py-2 rounded-full">
          <span>ğŸ’¡</span>
          <span>Tip: Excel and CSV files are supported</span>
        </div>
      </div>
    <% end %>
  </div>
</div>
